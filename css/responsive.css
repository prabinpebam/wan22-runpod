@media (max-width: 1024px) {
    :root {
        --sidebar-width: min(360px, 85vw);
    }

    .app-title {
        font-size: 1.25rem;
    }

    .crop-controls-panel {
        min-width: 280px;
    }

    .crop-modal-fullscreen {
        width: min(1280px, 96vw);
        padding: var(--space-lg);
        gap: var(--space-lg);
    }
}

@media (max-width: 768px) {
    :root {
        --sidebar-width: min(360px, 85vw);
    }

    body {
        position: relative;
        overflow: auto;
        height: auto;
    }

    .app-container {
        height: auto;
        min-height: calc((var(--vh, 1vh) * 100));
    }

    .main-content {
        height: auto;
        min-height: calc((var(--vh, 1vh) * 100) - var(--header-height));
    }

    .hamburger-button {
        display: flex;
    }

    .generation-panel {
        width: var(--sidebar-width);
        max-width: var(--sidebar-width);
        min-height: calc((var(--vh, 1vh) * 100) - var(--header-height));
        max-height: calc((var(--vh, 1vh) * 100) - var(--header-height));
    }

    .queue-panel {
        margin-left: 0;
        height: auto;
        min-height: calc((var(--vh, 1vh) * 100) - var(--header-height));
    }

    .modal-overlay {
        align-items: stretch;
        justify-content: flex-start;
        padding: 0;
    }

    .modal-content {
        width: 100%;
        max-width: none;
        height: auto;
        max-height: none;
    }

    .modal-content.crop-modal {
        width: 100vw;
        max-width: 100vw;
        height: calc((var(--vh, 1vh) * 100));
        max-height: calc((var(--vh, 1vh) * 100));
        border-radius: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
    }

    .modal-content.crop-modal .modal-header {
        padding: var(--space-md);
    }

    .crop-modal-fullscreen {
        width: 100vw;
        height: calc((var(--vh, 1vh) * 100));
    }

    .crop-modal-body {
        flex: 1;
        padding: 0;
        display: flex;
        flex-direction: column;
        overflow-y: auto;
    }

    .crop-modal-fullscreen .crop-container {
        order: 1;
        flex: 0 0 auto;
        padding: var(--space-md);
        min-height: 50vh;
        max-height: none;
    }

    .crop-controls-panel {
        order: 2;
        flex: 0 0 auto;
        width: 100%;
        min-width: 0;
        border-right: none;
        border-top: 1px solid var(--border-color);
        max-height: none;
        overflow: visible;
        background-color: var(--surface-color);
    }

    body.drag-over::after {
        font-size: 20px;
        padding: 30px 40px;
    }

    .app-title {
        display: none;
    }
}

@media (max-width: 640px) {
    .settings-button,
    .queue-action-btn,
    .action-button,
    .modal-button {
        width: var(--icon-button-size);
        min-width: var(--icon-button-size);
        height: var(--icon-button-size);
        padding: 0;
        border-radius: 999px;
        font-size: 0;
        gap: 0;
    }

    .settings-button i,
    .queue-action-btn i,
    .action-button i,
    .modal-button i {
        margin: 0;
        font-size: 1.15rem;
    }

    .queue-action-btn .button-text,
    .action-button .button-text {
        display: none;
    }
}

@media (max-width: 480px) {
    .crop-handle {
        width: 52px;
        height: 52px;
        border: 4px solid white;
    }

    .handle-nw { top: -26px; left: -26px; }
    .handle-ne { top: -26px; right: -26px; }
    .handle-sw { bottom: -26px; left: -26px; }
    .handle-se { bottom: -26px; right: -26px; }
}

@supports (-webkit-touch-callout: none) {
    .app-container {
        height: 100vh;
        height: var(--vh, 100vh);
    }

    .main-content {
        height: calc(100vh - var(--header-height));
        height: calc(var(--vh, 100vh) - var(--header-height));
    }

    .generation-panel,
    .queue-panel {
        height: calc(100vh - var(--header-height));
        height: calc(var(--vh, 100vh) - var(--header-height));
    }

    .crop-modal-fullscreen {
        height: 100vh;
        height: var(--vh, 100vh);
    }
}
